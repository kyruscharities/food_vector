-#- content_for :head do
= javascript_tag do
  var center_point = #{raw @analysis.geo_region.center_point.to_json}
  var food_data = #{raw @analysis.analyzed_geo_blocks.to_json}

%section
  .col-md-12
    %h2.page-header
      = @analysis.name
      %span.pull-right
        = link_to 'Re-analyze', analyze_analysis_path(@analysis), method: :post, class: 'btn btn-primary' if @analysis.analyzed_at?

    %p.lead= @analysis.description

    .row
      .col-xs-10
        %p
          %b Region of interest:
          = lat_lon *@analysis.nw
          to
          = lat_lon *@analysis.se

        %p
          %b Resolution (mi):
          = @analysis.resolution_mi

      .col-xs-2
        - unless @analysis.analyzed_at?
          .alert.alert-info.text-center
            %i.fa.fa-4x.fa-spinner.fa-spin
            Analyzing

    - if @analysis.analyzed_at?
      %p
        %b Analyzed at:
        = @analysis.analyzed_at
      %p
        %b Number of blocks analyzed within the geo region:
        = @analysis.analyzed_geo_blocks.count
      %p
        %b Number of located food sources:
        - if @analysis.located_food_sources.empty?
          There are no food sources in this geo region!
        - else
          = @analysis.located_food_sources.count
      -#%p
      -#  %b Number of located unhealthy food sources:
      -#  - if @analysis.located_unhealthy_food_sources.empty?
      -#    There are no unhealthy food sources in this geo region.
      -#  - else
      -#    = @analysis.located_unhealthy_food_sources.count

      %div{style: 'width: 800px;'}
        #map{style: 'width: 800px; height: 400px;'}
